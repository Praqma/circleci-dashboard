(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{17:function(e,t,a){e.exports=a(38)},23:function(e,t,a){},25:function(e,t,a){},27:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(12),i=a.n(l),c=a(40),s=a(41),u=(a(23),a(6)),o=a(7),h=a(9),m=a(8),d=a(10),f=(a(25),a(3)),p=(a(27),"https://circleci.com/api/v1.1/"),b="circle-token=",v="circle_ci_token",g="repo_filter",E="branch_filter";function k(){var e=localStorage.getItem(v);return null!=e?e:""}function j(){var e=localStorage.getItem(g);return null!=e?e:""}function O(){var e=localStorage.getItem(E);return null!=e?e:""}function S(e){return fetch(p+e+(e&&e.indexOf("?")>-1?"&":"?")+b+k(),{method:"get"}).then(function(t){return t.ok?t.json():(console.error("Not fetching "+p+e+" - "+t.status+" "+t.satusText),null)},function(t){return console.error("Error fetching "+p+e+" - "+t.errorMessage),null})}function y(e,t){return t&&""!==t?new RegExp(t):e&&""!==e?new RegExp(e):null}function _(e,t){var a=y(O(),t);return a&&a.test(e)}var C=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).state={token:k(),repofilter:j(),branchfilter:O()},a.handleTokenChange=a.handleTokenChange.bind(Object(f.a)(Object(f.a)(a))),a.handleRepoFilterChange=a.handleRepoFilterChange.bind(Object(f.a)(Object(f.a)(a))),a.handleBranchFilterChange=a.handleBranchFilterChange.bind(Object(f.a)(Object(f.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(f.a)(Object(f.a)(a))),a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"handleTokenChange",value:function(e){this.setState({token:e.target.value}),localStorage.setItem(v,this.state.token)}},{key:"handleRepoFilterChange",value:function(e){this.setState({repofilter:e.target.value}),localStorage.setItem(g,this.state.repofilter)}},{key:"handleBranchFilterChange",value:function(e){this.setState({branchfilter:e.target.value}),localStorage.setItem(E,this.state.branchfilter)}},{key:"handleSubmit",value:function(e){e.preventDefault(),localStorage.setItem(v,this.state.token),localStorage.setItem(g,this.state.repofilter),localStorage.setItem(E,this.state.branchfilter)}},{key:"render",value:function(){return r.a.createElement("div",{className:"config"},r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("label",null,"CircleCI token:",r.a.createElement("input",{type:"text",value:this.state.token,onChange:this.handleTokenChange,size:"100"})),r.a.createElement("br",null),r.a.createElement("label",null,"Repo filter (include):",r.a.createElement("input",{type:"text",value:this.state.repofilter,onChange:this.handleRepoFilterChange,size:"100"})),r.a.createElement("br",null),r.a.createElement("label",null,"Branch filter (exclude):",r.a.createElement("input",{type:"text",value:this.state.branchfilter,onChange:this.handleBranchFilterChange,size:"100"})),r.a.createElement("br",null),r.a.createElement("input",{type:"submit",value:"Save to localStorage"})))}}]),t}(r.a.Component),I=a(13),w=a.n(I),x=a(14),N=a.n(x),F=a(15),R=a.n(F),T=function(e,t){return e.build_num>t.build_num?e:t},B=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).state={reponame:e.reponame,branch:decodeURIComponent(e.branch),url:e.url,build_num:e.build_num,data:null},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.fetch(),this.fetcher=setInterval(function(){return e.fetch()},3e4)}},{key:"componentWillUnmount",value:function(){clearInterval(this.fetcher)}},{key:"fetch",value:function(){var e=this;S(this.state.url).then(function(t){return e.setState({data:t.reduce(T)})})}},{key:"render",value:function(){if(null===this.state.data)return null;var e=this.state.data.stop_time;e||(e=this.state.data.start_time);var t=w()(e),a=t.isValid()?t.fromNow():"",n=R.a.url(this.state.data.author_email,{s:"100"}),l=this.state.data.author_name;this.state.data.user&&this.state.data.user.is_user&&(n=this.state.data.user.avatar_url,l=this.state.data.user.name?this.state.data.user.name:this.state.data.user.login);var i=N()({tile:!0,success:"success"===this.state.data.outcome,failed:"failed"===this.state.data.outcome,skipped:"not_run"===this.state.data.status,pending:"pending"===this.state.data.outcome||null==this.state.data.outcome});return r.a.createElement("div",{className:i},r.a.createElement("h1",null,this.state.reponame),r.a.createElement("div",{className:"branch"},r.a.createElement("span",null,this.state.branch)),r.a.createElement("div",{className:"build"},"Build #",this.state.data.build_num),r.a.createElement("div",{className:"email"},r.a.createElement("img",{src:n,alt:this.state.data.author_email,width:"75"})),r.a.createElement("div",{className:"author"},l),r.a.createElement("h2",null,this.state.data.status),r.a.createElement("div",{className:"date"},a))}}]),t}(r.a.Component),D=function(e,t){return e.build_num>t.build_num?e:t},M={},z=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).state={repofilter:e.match.params.repofilter,branchfilter:e.match.params.branchfilter,data:null},a}return Object(d.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.fetch(),this.fetcher=setInterval(function(){return e.fetch()},3e5)}},{key:"componentWillUnmount",value:function(){clearInterval(this.fetcher)}},{key:"fetch",value:function(){var e=this;S("projects").then(function(t){return e.setState({data:t})})}},{key:"getSortedTiles",value:function(){var e=this;return this.state.data?((M=this.state.data.flatMap(function(t){var a=[];if(function(e,t){var a=y(j(),t);return!a||a.test(e)}(t.reponame,e.state.repofilter))for(var n in t.branches)if(!_(n,e.state.branchfilter)){var r=t.branches[n].running_builds,l=t.branches[n].recent_builds;if(r&&l&&r.length+l.length!==0){var i=r.concat(l).reduce(D),c=t.reponame+n,s="project/"+t.vcs_type+"/"+t.username+"/"+t.reponame+"/tree/"+n+"?limit=5",u=t.reponame,o=Date.parse(i.added_at);a.push({key:c,url:s,reponame:u,branch:n,date:o})}}return a})).sort(function(e,t){return t.date-e.date}),M.map(function(e){return r.a.createElement(B,{key:e.key,url:e.url,reponame:e.reponame,branch:e.branch})})):[]}},{key:"render",value:function(){var e=this.getSortedTiles();return r.a.createElement("div",{className:"tiles"},e)}}]),t}(r.a.Component);i.a.render(r.a.createElement(c.a,null,r.a.createElement("div",null,r.a.createElement(s.a,{path:"/",exact:!0,component:z}),r.a.createElement(s.a,{path:"/repos/:repofilter",component:z}),r.a.createElement(s.a,{path:"/branches/:branchfilter",component:z}),r.a.createElement(s.a,{path:"/filter/:repofilter/:branchfilter",component:z}),r.a.createElement(s.a,{path:"/config",component:C}))),document.querySelector("#dashboard"))}},[[17,2,1]]]);
//# sourceMappingURL=main.a7e0cb1e.chunk.js.map